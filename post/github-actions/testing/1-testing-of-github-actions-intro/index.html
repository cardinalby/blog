<!doctype html><html prefix="og: http://ogp.me/ns#"><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Testing of GitHub Actions. Intro &#183; </title><meta name=description content="Introduction
In this post series I want to share my experience and approaches with testing of GitHub Actions. Not using them to test your application, but test actions itself. I will mostly talk about testing of individual actions, not workflows.
Individual actions (steps) are &ldquo;bricks&rdquo; that workflows are built from, and we can consider testing them as unit testing of workflows.
One of the problems of GitHub Actions as cloud-based service is that there is no out of the box way of test them locally. Also, support in developing tools is poor comparing to mainstream programming languages. These factors lead to the high errors rate and long feedback loop to find and fix these  errors."><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=generator content="Hugo 0.147.3"><meta name=robots content="index,follow"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="Testing of GitHub Actions. Intro"><meta property="og:description" content="Introduction
In this post series I want to share my experience and approaches with testing of GitHub Actions. Not using them to test your application, but test actions itself. I will mostly talk about testing of individual actions, not workflows.
Individual actions (steps) are &ldquo;bricks&rdquo; that workflows are built from, and we can consider testing them as unit testing of workflows.
One of the problems of GitHub Actions as cloud-based service is that there is no out of the box way of test them locally. Also, support in developing tools is poor comparing to mainstream programming languages. These factors lead to the high errors rate and long feedback loop to find and fix these  errors."><meta property="og:type" content="article"><meta property="og:url" content="https://cardinalby.github.io/blog/post/github-actions/testing/1-testing-of-github-actions-intro/"><link rel=stylesheet href=https://cardinalby.github.io/blog/dist/site.css><link rel=stylesheet href=https://cardinalby.github.io/blog/dist/syntax.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic"><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous><base href=https://cardinalby.github.io/blog/><link rel="shortcut icon" type=image/jpg href=favicon.png><link rel=stylesheet href=css/custom.css></head><body><script async src="https://www.googletagmanager.com/gtag/js?id=G-S1HYRNQV86"></script><script>var dnt,doNotTrack=!1;if(!0&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-S1HYRNQV86")}</script><div id=wrapper><header class=site-header><div class=container><div class=site-title-wrapper><h1 class=site-title><a href=https://cardinalby.github.io/blog/>Tech grumbling</a></h1><a class=button-square href=https://cardinalby.github.io/blog/index.xml aria-label=RSS><i class="fa fa-rss" aria-hidden=true></i></a>
<a class="button-square button-social hint--top" data-hint=Github aria-label=Github href=https://github.com/cardinalby rel=me><i class="fa fa-github-alt" aria-hidden=true></i>
</a><a class="button-square button-social hint--top" data-hint="Stack Overflow" aria-label="Stack Overflow" href=https://stackoverflow.com/users/1180397/cardinal rel=me><i class="fa fa-stack-overflow" aria-hidden=true></i>
</a><a class="button-square button-social hint--top" data-hint=LinkedIn aria-label=LinkedIn href=https://www.linkedin.com/in/sergey-borodin/ rel=me><i class="fa fa-linkedin" aria-hidden=true></i></a></div><ul class=site-nav><li class=site-nav-item><a href=/blog/>Blog</a></li><li class=site-nav-item><a href=/blog/project/>Projects</a></li><li class=site-nav-item><a href=/blog/tags/>Tags</a></li><li class=site-nav-item><a href=/blog/page/about/>About</a></li></ul></div></header><div id=container><div class=container><article class=post-container itemscope itemtype=http://schema.org/BlogPosting><header class=post-header><h1 class=post-title itemprop="name headline">Testing of GitHub Actions. Intro</h1><p class=post-date><span>Published <time datetime=2021-12-01 itemprop=datePublished>Dec 1, 2021</time></span>
<span>by</span>
<span itemscope itemprop=author itemtype=https://schema.org/Person><span itemprop=name><a href=# itemprop=url rel=author></a></span></span></p><p class="post-reading post-line"><span>Estimated reading time: 4 min</span></p></header><div class="post-content clearfix" itemprop=articleBody><img class=post-featured-image src=images/posts/github-actions/testing/title.png><div class=series-parts-block><div class=series-parts-title><div class=series-label>SERIES</div><div class=series-name><a href=/blog/series/testing-of-github-actions>Testing of GitHub Actions</a></div></div><div class="series-part current"><span class=circled-number>1</span>
<a href=https://cardinalby.github.io/blog/post/github-actions/testing/1-testing-of-github-actions-intro/>Testing of GitHub Actions. Intro</a></div><div class=series-part><span class=circled-number>2</span>
<a href=https://cardinalby.github.io/blog/post/github-actions/testing/2-testing-of-js-actions/>Testing of JavaScript Actions</a></div><div class=series-part><span class=circled-number>3</span>
<a href=https://cardinalby.github.io/blog/post/github-actions/testing/3-testing-of-docker-actions/>Testing of Docker Actions</a></div><div class=series-part><span class=circled-number>4</span>
<a href=https://cardinalby.github.io/blog/post/github-actions/testing/4-system-testing-of-github-actions/>System testing of GitHub Actions</a></div></div><h3 class=series-part-block-print-only>Post <b>1</b> of <b>4</b> in "Testing of GitHub Actions" series</h3><h1 id=introduction>Introduction</h1><p>In this post series I want to share my experience and approaches with testing of GitHub Actions. Not using them to test your application, but test actions itself. I will mostly talk about testing of individual actions, not workflows.</p><p><strong>Individual actions</strong> (steps) are &ldquo;bricks&rdquo; that workflows are built from, and we can consider testing them as unit testing of workflows.</p><p><strong>One of the problems</strong> of GitHub Actions as cloud-based service is that there is no out of the box way of test them locally. Also, support in developing tools is poor comparing to mainstream programming languages. These factors lead to the high errors rate and long feedback loop to find and fix these errors.</p><p>That&rsquo;s why I believe it&rsquo;s important to adapt best practices we use in software testing for GitHub Actions, and I&rsquo;m going to share my vision in it.</p><h1 id=overview>Overview</h1><p>In the first part I give a general information about GitHub Actions and testing levels. Then I formulate requirements for testing tools and tell about my choise.</p><p>If you want to see concrete recommendations and approaches, just jump to the next part.</p><h2 id=action-types>Action types</h2><p>At the moment, GitHub supports 3 kinds of Actions which I will refer to in this post:</p><ol><li><a href=https://docs.github.com/en/actions/creating-actions/creating-a-javascript-action target=_blank>JavaScript actions</a></li><li><a href=https://docs.github.com/en/actions/creating-actions/creating-a-docker-container-action target=_blank>Docker container actions</a></li><li><a href=https://docs.github.com/en/actions/creating-actions/creating-a-composite-action target=_blank>Composite actions</a></li></ol><h2 id=levels-of-testing-and-tools>Levels of testing and tools</h2><h3 id=-unit-testing>ðŸ”¸ Unit testing</h3><blockquote><p>A Unit is a smallest testable portion of system or application which can be compiled, liked, loaded, and executed.</p></blockquote><p>Depending on the action type, &ldquo;unit&rdquo; notion may have different meaning. I will cover it in
&ldquo;Docker actions&rdquo; and &ldquo;JavaScript actions&rdquo; parts.</p><p>For <strong>composite actions</strong>, individual steps can be considered units. If you don&rsquo;t hardcode <code>runs</code> commands in steps, but extract them to the separate actions instead (thankfully, they can be saved locally in the repo), then the unit testing approach reduces to the testing of individual actions. That&rsquo;s exactly what this post is about.</p><h3 id=-integration-testing>ðŸ”¸ Integration testing</h3><blockquote><p>In this testing phase, different software modules are combined and tested as a group to make sure that integrated system is ready for system testing. Integrating testing checks the data flow from one module to other modules.</p></blockquote><p>To perform integration testing of a GitHub Action we need a tool that:</p><ol><li>Runs locally and on CI runner (including GitHub runner).</li><li>Runs the whole action or its part.</li><li>Isolates running code and give testing code an access to action&rsquo;s inputs, outputs and environment.</li><li>Allows stubbing external services used by an action, such as GitHub API.</li></ol><p>Let&rsquo;s list what exactly we expect from such tool:</p><ul><li>Parsing action config (action.yml file)</li><li>Setting up action <a href=https://docs.github.com/en/enterprise-cloud@latest/actions/using-workflows/workflow-syntax-for-github-actions#jobsjob_idstepswith target=_blank>inputs</a> and <a href=https://docs.github.com/en/actions/using-workflows/workflow-commands-for-github-actions#sending-values-to-the-pre-and-post-actions target=_blank>saved state</a>.</li><li>Setting up <a href=https://docs.github.com/en/actions/learn-github-actions/environment-variables target=_blank>environment variables</a>: custom ones and service GitHub variables.</li><li>Setting up <code>GITHUB_EVENT_PATH</code> variable and faking JSON file with an event payload.</li><li>Faking <a href=https://docs.github.com/en/actions/using-workflows/workflow-commands-for-github-actions#environment-files target=_blank>command files</a> and setting up correspondent env variables (<code>GITHUB_ENV</code>, <code>GITHUB_PATH</code>).</li><li>Faking temp and workspace directories (and corresponding <code>RUNNER_TEMP</code> and <code>GITHUB_WORKSPACE</code> variables)</li><li>Intercepting and isolating stdout and stderr output. It&rsquo;s important, because being run on GitHub runner our tests can interfere with actual commands of test workflow.</li><li>Parsing intercepted output and faked command files to extract <a href=https://docs.github.com/en/actions/using-workflows/workflow-commands-for-github-actions target=_blank>commands</a> issued by tested code.</li></ul><p>I haven&rsquo;t found any handy solution that meet these requirements and it made me write my own TypeScript package for testing JavaScript and Docker actions called <a href=https://github.com/cardinalby/github-action-ts-run-api target=_blank>github-action-ts-run-api</a>. It has well typed JavaScript API with reasonable defaults, can be used with any JavaScript test framework or alone and covers all listed requirements.</p><p>In the following parts of the post I&rsquo;m going to tell about the testing techniques that become
possible with this package. For <strong>more code examples</strong> take a look at the <a href=https://github.com/cardinalby/github-action-ts-run-api#documentation target=_blank>package documentation</a>.</p><h3 id=-system-testing>ðŸ”¸ System testing</h3><blockquote><p>System testing is performed on a complete, integrated system. It allows checking systemâ€™s compliance as per the requirements. It tests the overall interaction of components. It involves load, performance, reliability and security testing.</p></blockquote><p>It can be debatable what to consider as system testing in case of GitHub Action.</p><h4 id=option-1>Option 1</h4><p>Testing the whole action behavior using the same tool as we use for integration testing, but exclude external services stubs if it possible.</p><h4 id=option-2>Option 2</h4><p>Testing action behavour in the workflow. The only existing solution for doing that locally is a great tool called <a href=https://github.com/nektos/act target=_blank>Act</a>.</p><div class=series-parts-block><div class=series-parts-title><div class=series-label>SERIES</div><div class=series-name><a href=/blog/series/testing-of-github-actions>Testing of GitHub Actions</a></div></div><div class="series-part current"><span class=circled-number>1</span>
<a href=https://cardinalby.github.io/blog/post/github-actions/testing/1-testing-of-github-actions-intro/>Testing of GitHub Actions. Intro</a></div><div class=series-part><span class=circled-number>2</span>
<a href=https://cardinalby.github.io/blog/post/github-actions/testing/2-testing-of-js-actions/>Testing of JavaScript Actions</a></div><div class=series-part><span class=circled-number>3</span>
<a href=https://cardinalby.github.io/blog/post/github-actions/testing/3-testing-of-docker-actions/>Testing of Docker Actions</a></div><div class=series-part><span class=circled-number>4</span>
<a href=https://cardinalby.github.io/blog/post/github-actions/testing/4-system-testing-of-github-actions/>System testing of GitHub Actions</a></div></div><h3 class=series-part-block-print-only>Post <b>1</b> of <b>4</b> in "Testing of GitHub Actions" series</h3></div><footer class="post-footer clearfix"><p class=post-tags><span>Tagged:</span>
<a href=/tags/github-actions/>github-actions</a>,
<a href=/tags/testing/>testing</a></p><div class=share></div></footer><div class=comments><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//https-cardinalby-github-io-blog.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></article></div></div></div><footer class=footer><div class=container><div class=site-title-wrapper><h1 class=site-title><a href=https://cardinalby.github.io/blog/>Tech grumbling</a></h1><a class="button-square button-jump-top js-jump-top" href=# aria-label="Back to Top"><i class="fa fa-angle-up" aria-hidden=true></i></a></div><p class=footer-copyright><span>&copy; 2024 / Powered by <a href=https://gohugo.io/>Hugo</a></span></p></div></footer><script src=https://cardinalby.github.io/blog/js/jquery-1.11.3.min.js></script><script src=https://cardinalby.github.io/blog/js/jquery.fitvids.js></script><script src=https://cardinalby.github.io/blog/js/scripts.js></script><script src=js/copy-code-to-clipboard.js></script><script src=js/add-header-anchors.js></script></body></html>